<?xml version="1.0" ?>
<!DOCTYPE html 
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Untitled</title>
</head>
<body>
<h2><a name="label-0" id="label-0">BDB::XML::Container</a></h2><!-- RDLabel: "BDB::XML::Container" -->
<p>The container name provides the base for the filenames of the database
files used to store the container content. The directory within which
the files are opened is taken from the environment passed through the
Container constructor.  If no environment was provided, then the
directory used will be the current working directory.</p>
<h3><a name="label-1" id="label-1">Class Methods</a></h3><!-- RDLabel: "Class Methods" -->
<dl>
<dt><a name="label-2" id="label-2"><code>allocate(<var>name</var> = <var>nil</var>, <var>options</var> = {})</code></a></dt><!-- RDLabel: "allocate" -->
<dd>
allocate a new Container object
<dl>
<dt><a name="label-3" id="label-3"><var>name</var></a></dt><!-- RDLabel: "name" -->
<dd>
the name of the container
</dd>
<dt><a name="label-4" id="label-4"><var>options</var></a></dt><!-- RDLabel: "options" -->
<dd>
Hash with the possible keys
<dl>
<dt><a name="label-5" id="label-5"><var>env</var></a></dt><!-- RDLabel: "env" -->
<dd>
the Berkeley DB environment within which all database
operations are to be performed.
</dd>
<dt><a name="label-6" id="label-6"><var>txn</var></a></dt><!-- RDLabel: "txn" -->
<dd>
the transaction within which all database
operations are to be performed.
</dd>
<dt><a name="label-7" id="label-7"><var>set_pagesize</var></a></dt><!-- RDLabel: "set_pagesize" -->
<dd>
Set the pagesize of the primary database (512 &lt; size &lt; 64K)
</dd>
</dl>
</dd>
</dl></dd>
<dt><a name="label-8" id="label-8"><code>dump(<var>name</var>, <var>filename</var>)</code></a></dt><!-- RDLabel: "dump" -->
<dd>
Dump the container <var>name</var> into the specified file.</dd>
<dt><a name="label-9" id="label-9"><code>load(<var>name</var>, <var>filename</var>)</code></a></dt><!-- RDLabel: "load" -->
<dd>
Load data from the specified file into the container <var>name</var></dd>
<dt><a name="label-10" id="label-10"><code>remove(<var>name</var>)</code></a></dt><!-- RDLabel: "remove" -->
<dd>
Remove the container <var>name</var></dd>
<dt><a name="label-11" id="label-11"><code>rename(<var>name</var>, <var>newname</var>)</code></a></dt><!-- RDLabel: "rename" -->
<dd>
Rename the container <var>name</var></dd>
<dt><a name="label-12" id="label-12"><code>salvage(<var>name</var>, <var>filename</var>, <var>flags</var> = <var>0</var>)</code></a></dt><!-- RDLabel: "salvage" -->
<dd>
Verify the container <var>name</var>, and save the content in <var>filename</var>
<dl>
<dt><a name="label-13" id="label-13"><var>flags</var></a></dt><!-- RDLabel: "flags" -->
<dd>
flags can has the value <var>BDB::AGGRESSIVE</var>
</dd>
</dl></dd>
<dt><a name="label-14" id="label-14"><code>set_name(<var>name</var>, <var>str</var>)</code></a></dt><!-- RDLabel: "set_name" -->
<dd>
Set the name for the container <var>name</var>. The underlying files for the
container are not renamed - for that, see <var>Container::rename</var></dd>
<dt><a name="label-15" id="label-15"><code>verify(<var>name</var>)</code></a></dt><!-- RDLabel: "verify" -->
<dd>
Verify the container <var>name</var></dd>
</dl>
<h3><a name="label-16" id="label-16">Methods</a></h3><!-- RDLabel: "Methods" -->
<dl>
<dt><a name="label-17" id="label-17"><code>close(<var>flags</var> = <var>0</var>)</code></a></dt><!-- RDLabel: "close" -->
<dd>
close an open container
<dl>
<dt><a name="label-18" id="label-18"><var>flags</var></a></dt><!-- RDLabel: "flags" -->
<dd>
flags can has the value 0 or <var>BDB::NOSYNC</var>
</dd>
</dl></dd>
<dt><a name="label-19" id="label-19"><code>delete(<var>document</var>, <var>flags</var> = <var>0</var>)</code></a></dt><!-- RDLabel: "delete" -->
<dd>
Remove the document from the container
<dl>
<dt><a name="label-20" id="label-20"><var>document</var></a></dt><!-- RDLabel: "document" -->
<dd>
document can be an ID or an <var>BDB::XML::Document</var> previously stored
</dd>
<dt><a name="label-21" id="label-21"><var>flags</var></a></dt><!-- RDLabel: "flags" -->
<dd>
flags can has the value 0 or <var>BDB::AUTO_COMMIT</var>
</dd>
</dl></dd>
<dt><a name="label-22" id="label-22"><code>environment</code></a></dt><!-- RDLabel: "environment" -->
<dt><a name="label-23" id="label-23"><code>env</code></a></dt><!-- RDLabel: "env" -->
<dd>
return the current environment for the container, or <var>nil</var></dd>
<dt><a name="label-24" id="label-24"><code>environment?</code></a></dt><!-- RDLabel: "environment?" -->
<dt><a name="label-25" id="label-25"><code>env?</code></a></dt><!-- RDLabel: "env?" -->
<dd>
return <var>true</var> if the container was opend in an environment</dd>
<dt><a name="label-26" id="label-26"><code>each {|<var>doc</var>| ... }</code></a></dt><!-- RDLabel: "each" -->
<dd>
Iterate over all documents</dd>
<dt><a name="label-27" id="label-27"><code>self[id]</code></a></dt><!-- RDLabel: "self[id]" -->
<dt><a name="label-28" id="label-28"><code>get(<var>id</var>, <var>flags</var> = <var>0</var>)</code></a></dt><!-- RDLabel: "get" -->
<dd>
Fetch the document from the container
<dl>
<dt><a name="label-29" id="label-29"><var>id</var></a></dt><!-- RDLabel: "id" -->
<dd>
the id assigned to the document when it was first added to a container
</dd>
<dt><a name="label-30" id="label-30"><var>flags</var></a></dt><!-- RDLabel: "flags" -->
<dd>
flags can has the value 0 or <var>BDB::DIRTY_READ</var>, <var>BDB::RMW</var>
</dd>
</dl></dd>
<dt><a name="label-31" id="label-31"><code>self[id] = <var>document</var></code></a></dt><!-- RDLabel: "self[id] = document" -->
<dd>
Replace the document (see also #update)</dd>
<dt><a name="label-32" id="label-32"><code>index=(<var>index</var>)</code></a></dt><!-- RDLabel: "index=" -->
<dd>
set the indexing : <var>index</var> must be an <var>BDB::XML::Index</var> object</dd>
<dt><a name="label-33" id="label-33"><code>index</code></a></dt><!-- RDLabel: "index" -->
<dd>
<p>Retrieve the <var>BDB::XML::Index</var></p>
<p>Return <var>nil</var> if no indexing was specified</p></dd>
<dt><a name="label-34" id="label-34"><code>initialize(<var>name</var>, <var>flags</var> = <var>0</var>, <var>mode</var> = <var>0</var>)</code></a></dt><!-- RDLabel: "initialize" -->
<dd>
open the container
<dl>
<dt><a name="label-35" id="label-35"><var>name</var></a></dt><!-- RDLabel: "name" -->
<dd>
see <var>allocate</var>
</dd>
<dt><a name="label-36" id="label-36"><var>flags</var></a></dt><!-- RDLabel: "flags" -->
<dd>
The flags must be the string "r", "r+", "w", "w+", "a", "a+" or
and integer value.
</dd>
<dt><a name="label-37" id="label-37"><var>mode</var></a></dt><!-- RDLabel: "mode" -->
<dd>
mode for creation (see chmod(2))
</dd>
</dl></dd>
<dt><a name="label-38" id="label-38"><code>modify(<var>mod</var>, <var>context</var> = <var>nil</var>, <var>flags</var> = <var>0</var>)</code></a></dt><!-- RDLabel: "modify" -->
<dd>
<p>in-place modification of all documents according to the state of the 
<var>BDB::XML::Modify</var> object, which contains an XPath expression to 
target document nodes, as well as specification of the modifications 
to perform</p>
<p><var>context</var> is an optional <var>BDB::XML::Context</var> used for the update
operations on the container.</p>
<p><var>flags</var> must be set to zero or <var>BDB::RMW</var> to acquire a write lock</p></dd>
<dt><a name="label-39" id="label-39"><code>name</code></a></dt><!-- RDLabel: "name" -->
<dd>
return the name of the container</dd>
<dt><a name="label-40" id="label-40"><code>name=(<var>str</var>)</code></a></dt><!-- RDLabel: "name=" -->
<dd>
Set the name of the container. Can be called only on a closed container
See also <var>Container::set_name</var></dd>
<dt><a name="label-41" id="label-41"><code>open?</code></a></dt><!-- RDLabel: "open?" -->
<dd>
return <var>true</var> if the container is open</dd>
<dt><a name="label-42" id="label-42"><code>parse(<var>query</var>, <var>context</var> = <var>nil</var>)</code></a></dt><!-- RDLabel: "parse" -->
<dd>
Pre-parse an XPath query and return an <var>BDB::XML::XPath</var> object
<dl>
<dt><a name="label-43" id="label-43"><var>query</var></a></dt><!-- RDLabel: "query" -->
<dd>
the XPath query to execute against the container
</dd>
<dt><a name="label-44" id="label-44"><var>context</var></a></dt><!-- RDLabel: "context" -->
<dd>
the context within which the query will be executed
</dd>
</dl></dd>
<dt><a name="label-45" id="label-45"><code>push(<var>document</var>, <var>flags</var> = <var>0</var>)</code></a></dt><!-- RDLabel: "push" -->
<dd>
Add a document to the container and return an ID
<dl>
<dt><a name="label-46" id="label-46"><var>document</var></a></dt><!-- RDLabel: "document" -->
<dd>
an object <var>BDB::XML::Document</var> or any object suitable for 
<var>BDB::XML::Document::new</var>
</dd>
<dt><a name="label-47" id="label-47"><var>flags</var></a></dt><!-- RDLabel: "flags" -->
<dd>
flags can be 0 or <var>BDB::AUTO_COMMIT</var>
</dd>
</dl></dd>
<dt><a name="label-48" id="label-48"><code>&lt;&lt;(<var>document</var>)</code></a></dt><!-- RDLabel: "<<" -->
<dd>
Add a document to the container and return <var>self</var></dd>
<dt><a name="label-49" id="label-49"><code>query(<var>xpath</var>, <var>flags</var> = <var>0</var>)</code></a></dt><!-- RDLabel: "query" -->
<dt><a name="label-50" id="label-50"><code>query(<var>string</var>, <var>context</var>, <var>flags</var> = <var>0</var>)</code></a></dt><!-- RDLabel: "query" -->
<dd>
<p>Query the container with an XPath expression, which can be an object
<var>BDB::XML::XPath</var> or a <var>String</var></p>
<dl>
<dt><a name="label-51" id="label-51"><var>flags</var></a></dt><!-- RDLabel: "flags" -->
<dd>
flags can have the value 0 or <var>BDB::DIRTY_READ</var>, <var>BDB::RMW</var>
</dd>
</dl>
<p>return a <var>BDB::XML::Results</var> object</p></dd>
<dt><a name="label-52" id="label-52"><code>search(<var>xpath</var>, <var>returntype</var> = <var>BDB</var>::<var>XML</var>::<var>Context</var>::<var>Document</var>) {|<var>doc</var>| ... }</code></a></dt><!-- RDLabel: "search" -->
<dd>
<p>Iterate over the result of a query</p>
<p><var>returntype</var> can have the values <var>BDB::XML::Context::Document</var>
or <var>BDB::XML::Context::Values</var></p>
<p>the query is evaluated lazily</p></dd>
<dt><a name="label-53" id="label-53"><code>transaction</code></a></dt><!-- RDLabel: "transaction" -->
<dd>
return the transaction associated with the container, or <var>nil</var></dd>
<dt><a name="label-54" id="label-54"><code>in_transaction?</code></a></dt><!-- RDLabel: "in_transaction?" -->
<dt><a name="label-55" id="label-55"><code>transaction?</code></a></dt><!-- RDLabel: "transaction?" -->
<dd>
return <var>true</var> if the container is associated with a transaction</dd>
<dt><a name="label-56" id="label-56"><code>update(<var>document</var>)</code></a></dt><!-- RDLabel: "update" -->
<dd>
Update a document within the container</dd>
<dt><a name="label-57" id="label-57"><code>update_context {|<var>cxt</var>| ... }</code></a></dt><!-- RDLabel: "update_context" -->
<dt><a name="label-58" id="label-58"><code>context {|<var>cxt</var>| ... }</code></a></dt><!-- RDLabel: "context" -->
<dd>
<p>return an <var>BDB::XML::UpdateContext</var> which can be used to perform
<var>[]</var>, <var>[]=</var>, <var>push</var>, <var>delete</var>, <var>update</var> operation</p>
<p>This can be used for a performance improvement</p></dd>
</dl>

</body>
</html>
