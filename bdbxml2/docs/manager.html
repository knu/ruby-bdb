<?xml version="1.0" ?>
<!DOCTYPE html 
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>docs/manager.rd</title>
</head>
<body>
<h2><a name="label-0" id="label-0">BDB::XML::Manager</a></h2><!-- RDLabel: "BDB::XML::Manager" -->
<p>Provides a high-level object used to manage various aspects of Berkeley
DB XML usage. You use XML::Manager to perform activities such as container
management (including creation and open), preparing XML::Query queries, 
executing one-off queries, creating transaction objects, 
creating update and query context objects</p>
<p>A XML::Manager object can be created with BDB::Env#manager</p>
<p>BDB::Transaction respond to the same method than BDB::XML::Manager</p>
<h3><a name="label-1" id="label-1">Class Methods</a></h3><!-- RDLabel: "Class Methods" -->
<dl>
<dt><a name="label-2" id="label-2"><code>new(<var>flags</var> = <var>0</var>)</code></a></dt><!-- RDLabel: "new" -->
<dd>
create a new Manager object that uses a private internal 
database environment
<dl>
<dt><a name="label-3" id="label-3"><var>flags</var></a></dt><!-- RDLabel: "flags" -->
<dd>
flags can have the value
<dl>
<dt><a name="label-4" id="label-4">BDB::XML::ALLOW_EXTERNAL_ACCESS</a></dt><!-- RDLabel: "BDB::XML::ALLOW_EXTERNAL_ACCESS" -->
<dd>
to allow queries to access external data sources
</dd>
<dt><a name="label-5" id="label-5">BDB::XML::ALLOW_AUTO_OPEN</a></dt><!-- RDLabel: "BDB::XML::ALLOW_AUTO_OPEN" -->
<dd>
to allow queries that reference unopened containers will
automatically open those containers
</dd>
</dl>
</dd>
</dl></dd>
</dl>
<h3><a name="label-6" id="label-6">Methods</a></h3><!-- RDLabel: "Methods" -->
<dl>
<dt><a name="label-7" id="label-7"><code>create_container(<var>name</var>, <var>flags</var> = <var>0</var>, <var>type</var> = <var>XML</var>::<var>Container</var>::<var>NodeContainer</var>, <var>mode</var> = <var>0</var>)</code></a></dt><!-- RDLabel: "create_container" -->
<dd>
Creates and opens a container. If the container already exists at 
the time this method is called, an exception is thrown.
<dl>
<dt><a name="label-8" id="label-8"><var>name</var></a></dt><!-- RDLabel: "name" -->
<dd>
container's name
</dd>
<dt><a name="label-9" id="label-9"><var>flags</var></a></dt><!-- RDLabel: "flags" -->
<dd>
the flags to use for this container creation.
</dd>
<dt><a name="label-10" id="label-10"><var>type</var></a></dt><!-- RDLabel: "type" -->
<dd>
the type of container to create.
</dd>
<dt><a name="label-11" id="label-11"><var>mode</var></a></dt><!-- RDLabel: "mode" -->
<dd>
mode for creation (see chmod(2))
</dd>
</dl></dd>
<dt><a name="label-12" id="label-12"><code>create_document</code></a></dt><!-- RDLabel: "create_document" -->
<dd>
create a XML::Document object</dd>
<dt><a name="label-13" id="label-13"><code>create_modify</code></a></dt><!-- RDLabel: "create_modify" -->
<dd>
create a XML::Modify object</dd>
<dt><a name="label-14" id="label-14"><code>create_query_context(<var>rt</var> = <var>XML</var>::<var>Context</var>::<var>LiveValues</var>, <var>et</var> = <var>XML</var>::<var>Context</var>::<var>Eager</var>)</code></a></dt><!-- RDLabel: "create_query_context" -->
<dd>
create a XML::Context object
<dl>
<dt><a name="label-15" id="label-15"><var>rt</var></a></dt><!-- RDLabel: "rt" -->
<dd>
specifies whether to return live (XML::Context::LiveValues)
or dead values (XML::Context::DeadValues)
</dd>
<dt><a name="label-16" id="label-16"><var>et</var></a></dt><!-- RDLabel: "et" -->
<dd>
specifies if the resultants values are derived and 
stored in-memory before query evaluation is completed 
(XML::Context::Eager) or if they are calculated as you ask for them
(XML::Query::Lazy)
</dd>
</dl></dd>
<dt><a name="label-17" id="label-17"><code>create_results</code></a></dt><!-- RDLabel: "create_results" -->
<dd>
create a XML::Results object</dd>
<dt><a name="label-18" id="label-18"><code>begin(<var>flags</var> = <var>0</var>)</code></a></dt><!-- RDLabel: "begin" -->
<dd>
create a new transaction
<ul>
<li><var>flags</var></li>
</ul></dd>
<dt><a name="label-19" id="label-19"><code>create_update_context</code></a></dt><!-- RDLabel: "create_update_context" -->
<dd>
create a XML::Update object</dd>
<dt><a name="label-20" id="label-20"><code>dump_container(<var>name</var>, <var>path</var>)</code></a></dt><!-- RDLabel: "dump_container" -->
<dt><a name="label-21" id="label-21"><code>dump_container(<var>name</var>, <var>io</var>, <var>to_close</var> = <var>false</var>)</code></a></dt><!-- RDLabel: "dump_container" -->
<dd>
Dumps the contents of the specified container.
<dl>
<dt><a name="label-22" id="label-22"><var>name</var></a></dt><!-- RDLabel: "name" -->
<dd>
name of the container
</dd>
<dt><a name="label-23" id="label-23"><var>path</var></a></dt><!-- RDLabel: "path" -->
<dd>
the pathname of the file where the contents will be dumped
</dd>
<dt><a name="label-24" id="label-24"><var>io</var></a></dt><!-- RDLabel: "io" -->
<dd>
object which respond to #write
</dd>
<dt><a name="label-25" id="label-25"><var>to_close</var></a></dt><!-- RDLabel: "to_close" -->
<dd>
if an IO object was given, specify if this object
must be closed at the end.
</dd>
</dl></dd>
<dt><a name="label-26" id="label-26"><code>env</code></a></dt><!-- RDLabel: "env" -->
<dd>
Returns the underlying environnement</dd>
<dt><a name="label-27" id="label-27"><code>home</code></a></dt><!-- RDLabel: "home" -->
<dd>
Returns the home directory for the underlying database environment</dd>
<dt><a name="label-28" id="label-28"><code>load_container(<var>name</var>, <var>path</var>, <var>update</var> = <var>nil</var>)</code></a></dt><!-- RDLabel: "load_container" -->
<dt><a name="label-29" id="label-29"><code>load_container(<var>name</var>, <var>io</var>, <var>to_close</var> = <var>false</var>, <var>update</var> = <var>nil</var>)</code></a></dt><!-- RDLabel: "load_container" -->
<dd>
Loads data from the specified path (or io) into the container.
<dl>
<dt><a name="label-30" id="label-30"><var>name</var></a></dt><!-- RDLabel: "name" -->
<dd>
name of the container to load.
</dd>
<dt><a name="label-31" id="label-31"><var>path</var></a></dt><!-- RDLabel: "path" -->
<dd>
the pathname of the file which contains the data.
</dd>
<dt><a name="label-32" id="label-32"><var>io</var></a></dt><!-- RDLabel: "io" -->
<dd>
an object which respond to #read
</dd>
<dt><a name="label-33" id="label-33"><var>update</var></a></dt><!-- RDLabel: "update" -->
<dd>
an optional update context
</dd>
</dl></dd>
<dt><a name="label-34" id="label-34"><code>open_container(<var>name</var>, <var>flags</var> = <var>0</var>)</code></a></dt><!-- RDLabel: "open_container" -->
<dd>
Opens a container and return an XML::Container object
<dl>
<dt><a name="label-35" id="label-35"><var>name</var></a></dt><!-- RDLabel: "name" -->
<dd>
the container's name
</dd>
<dt><a name="label-36" id="label-36"><var>flags</var></a></dt><!-- RDLabel: "flags" -->
<dd>
the flags to use for this container open. Specify
BDB::CREATE to create and open a new container.
</dd>
</dl></dd>
<dt><a name="label-37" id="label-37"><code>prepare(<var>query</var>, <var>context</var> = <var>nil</var>)</code></a></dt><!-- RDLabel: "prepare" -->
<dd>
<p>Compile a Query expression and return a new XML::Query object.</p>
<p>You can then use XML::Query#execute</p>
<dl>
<dt><a name="label-38" id="label-38"><var>query</var></a></dt><!-- RDLabel: "query" -->
<dd>
the query to compile
</dd>
<dt><a name="label-39" id="label-39"><var>context</var></a></dt><!-- RDLabel: "context" -->
<dd>
an optional query context
</dd>
</dl></dd>
<dt><a name="label-40" id="label-40"><code>query(<var>query</var>, <var>context</var> = <var>nil</var>) [{<var>res</var>| ... }</code></a></dt><!-- RDLabel: "query" -->
<dd>
<p>Execute a query. If a block is given it will call Xml::Results#each for
the results, or it will return an Xml::Results object</p>
<p>This is equivalent to call XML::Manager#prepare and then 
XML::Query#execute</p>
<dl>
<dt><a name="label-41" id="label-41"><var>query</var></a></dt><!-- RDLabel: "query" -->
<dd>
the query to compile
</dd>
<dt><a name="label-42" id="label-42"><var>context</var></a></dt><!-- RDLabel: "context" -->
<dd>
an optional query context
</dd>
</dl></dd>
<dt><a name="label-43" id="label-43"><code>resolver = <var>object</var></code></a></dt><!-- RDLabel: "resolver = object" -->
<dd>
<p>Register a resolver</p>
<p>A resolver is an object which can respond to #resolve_collection,
#resolve_document, #resolve_entity, or #resolve_schema</p></dd>
<dt><a name="label-44" id="label-44"><code>remove_container(<var>name</var>)</code></a></dt><!-- RDLabel: "remove_container" -->
<dd>
Remove a container
<dl>
<dt><a name="label-45" id="label-45"><var>name</var></a></dt><!-- RDLabel: "name" -->
<dd>
the name of the container to be removed. The container
must be closed
</dd>
</dl></dd>
<dt><a name="label-46" id="label-46"><code>rename_container(<var>old_name</var>, <var>new_name</var>)</code></a></dt><!-- RDLabel: "rename_container" -->
<dd>
Rename a container
<dl>
<dt><a name="label-47" id="label-47"><var>old_name</var></a></dt><!-- RDLabel: "old_name" -->
<dd>
the name of the container to be renamed. 
The container must be closed and must have been opened at least once
</dd>
<dt><a name="label-48" id="label-48"><var>new_name</var></a></dt><!-- RDLabel: "new_name" -->
<dd>
its new name
</dd>
</dl></dd>
<dt><a name="label-49" id="label-49"><code>container_flags</code></a></dt><!-- RDLabel: "container_flags" -->
<dd>
Return the default container flags</dd>
<dt><a name="label-50" id="label-50"><code>container_flags = <var>flags</var></code></a></dt><!-- RDLabel: "container_flags = flags" -->
<dd>
Set the default container flags for new XML::Container</dd>
<dt><a name="label-51" id="label-51"><code>container_type</code></a></dt><!-- RDLabel: "container_type" -->
<dd>
Return the default container type</dd>
<dt><a name="label-52" id="label-52"><code>container_type = <var>type</var></code></a></dt><!-- RDLabel: "container_type = type" -->
<dd>
Set the default container type for new XML::Container</dd>
<dt><a name="label-53" id="label-53"><code>pagesize</code></a></dt><!-- RDLabel: "pagesize" -->
<dd>
Return the current page size value</dd>
<dt><a name="label-54" id="label-54"><code>pagesize = <var>size</var></code></a></dt><!-- RDLabel: "pagesize = size" -->
<dd>
Set the current page size value</dd>
<dt><a name="label-55" id="label-55"><code>update_container(<var>name</var>, <var>context</var> = <var>nil</var>)</code></a></dt><!-- RDLabel: "update_container" -->
<dd>
Upgrades the container from a previous version of Berkeley DB XML
<dl>
<dt><a name="label-56" id="label-56"><var>name</var></a></dt><!-- RDLabel: "name" -->
<dd>
name of the container to be upgraded
</dd>
<dt><a name="label-57" id="label-57"><var>context</var></a></dt><!-- RDLabel: "context" -->
<dd>
an optional update context
</dd>
</dl></dd>
<dt><a name="label-58" id="label-58"><code>verify_container(<var>name</var>, <var>flags</var> = <var>0</var>)</code></a></dt><!-- RDLabel: "verify_container" -->
<dt><a name="label-59" id="label-59"><code>verify_container(<var>name</var>, <var>path</var>, <var>flags</var> = <var>BDB</var>::<var>SALVAGE</var>)</code></a></dt><!-- RDLabel: "verify_container" -->
<dt><a name="label-60" id="label-60"><code>verify_container(<var>name</var>, <var>io</var>, <var>to_close</var> = <var>false</var>, <var>flags</var> = <var>BDB</var>::<var>SALVAGE</var>)</code></a></dt><!-- RDLabel: "verify_container" -->
<dd>
Checks that the container data files are not corrupt, and optionally 
writes the salvaged container data to the specified pathname.
<dl>
<dt><a name="label-61" id="label-61"><var>name</var></a></dt><!-- RDLabel: "name" -->
<dd>
name of the container
</dd>
<dt><a name="label-62" id="label-62"><var>path</var></a></dt><!-- RDLabel: "path" -->
<dd>
name of the file where the container will be
dumped if BDB::SALVAGE is set.
</dd>
<dt><a name="label-63" id="label-63"><var>io</var></a></dt><!-- RDLabel: "io" -->
<dd>
an object which respond to #write if BDB::SALVAGE is set
</dd>
<dt><a name="label-64" id="label-64"><var>to_close</var></a></dt><!-- RDLabel: "to_close" -->
<dd>
if true the io will be closed at end.
</dd>
<dt><a name="label-65" id="label-65"><var>flags</var></a></dt><!-- RDLabel: "flags" -->
<dd>
can have the value BDB::SALVAGE, BDB::AGGRESSIVE
</dd>
</dl></dd>
</dl>

</body>
</html>
